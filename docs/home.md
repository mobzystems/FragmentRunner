<div class="wikidoc">
<p><strong>Project Description</strong><br>
Simple but surprisingly powerful tool to quickly try out .NET fragments in C#, VB.NET and JScript.<br>
<br>
<strong>Usage</strong><br>
Simply select the language you want to use, type in your code fragment and press F5 to run it:<br>
<br>
<img title="Screenshot.png" alt="Screenshot.png" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=fragmentrunner&DownloadId=810222"><br>
<br>
<strong>Reusable library</strong><br>
Part of the source code is a library enabling you to create in-memory, executable assemblies. You can both capture their console-like output and the return value.</p>
<pre style="font-family:consolas; background:white; color:black"><span style="color:blue">Sub</span> Main()<br>&nbsp;&nbsp; <span style="color:green">' Create a compiler for C#. Also supports VB.NET and JScript<br></span>&nbsp;&nbsp; <span style="color:blue">Dim</span> compiler <span style="color:blue">As</span>&nbsp;<span style="color:#2b91af">FragmentCompiler</span> =<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#2b91af">FragmentCompiler</span>.CreateCompiler(<span style="color:#2b91af">FragmentCompiler</span>.<span style="color:#2b91af">LanguageTypeEnum</span>.CSharp)<br>&nbsp;&nbsp; <span style="color:green">' Compile a source code fragment that returns something based on its arguments<br></span>&nbsp;&nbsp; <span style="color:blue">Dim</span> c <span style="color:blue">As</span>&nbsp;<span style="color:#2b91af">CodeFragment</span> = compiler.CompileExpression(<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#a31515">&quot;PrintLine(&quot;&quot;Executed at &quot;&quot; &#43; DateTime.Now.Ticks.ToString());&quot;</span> &#43;<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#a31515">&quot;if (args.Length == 0) return &quot;&quot;Nothing to do!&quot;&quot;;&quot;</span> &#43;<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#a31515">&quot;if (args.Length == 1) return args[0];&quot;</span> &#43;<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#a31515">&quot;return args.Length;&quot;<br></span>&nbsp;&nbsp; )<br>&nbsp;&nbsp; <span style="color:green">' If compiling succeeded, run the fragment three times and display the result<br></span>&nbsp;&nbsp; <span style="color:blue">If</span> c.Succeeded <span style="color:blue">Then<br></span>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:green">' No arguments --&gt; &quot;Nothing to do!&quot;<br></span>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#2b91af">Console</span>.WriteLine(c.Run())<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#2b91af">Console</span>.Write(c.Output)<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:green">' A single argument --&gt; &quot;and a one&quot;<br></span>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#2b91af">Console</span>.WriteLine(c.Run(<span style="color:blue">New</span>&nbsp;<span style="color:blue">String</span>() {<span style="color:#a31515">&quot;and a one&quot;</span>}))<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#2b91af">Console</span>.Write(c.Output)<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:green">' More than 1 argument --&gt; &quot;2&quot;<br></span>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#2b91af">Console</span>.WriteLine(c.Run(<span style="color:blue">New</span>&nbsp;<span style="color:blue">String</span>() {<span style="color:#a31515">&quot;one&quot;</span>, <span style="color:#a31515">&quot;two&quot;</span>}))<br>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#2b91af">Console</span>.Write(c.Output)<br>&nbsp;&nbsp; <span style="color:blue">Else<br></span>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:green">' On errors, dump the first error<br></span>&nbsp;&nbsp;&nbsp;&nbsp; <span style="color:#2b91af">Console</span>.Error.WriteLine(c.Errors(0).ErrorText)<br>&nbsp;&nbsp; <span style="color:blue">End</span>&nbsp;<span style="color:blue">If</span>
<span style="color:blue">End</span>&nbsp;<span style="color:blue">Sub</span></pre>
<h3><font style="font-weight:bold">Example: Function Plotter</font></h3>
<p>A Code Fragment is also used to produce the following plot in another example program: FuncPlotter.</p>
<p><a href="http://download-codeplex.sec.s-msft.com/Download?ProjectName=fragmentrunner&DownloadId=810696"><img title="image" border="0" alt="image" src="http://download-codeplex.sec.s-msft.com/Download?ProjectName=fragmentrunner&DownloadId=810697" width="603" height="592" style="border-top:0px; border-right:0px; border-bottom:0px; padding-top:0px; padding-left:0px; border-left:0px; display:inline; padding-right:0px"></a></p>
<p>The <a href="https://fragmentrunner.codeplex.com/SourceControl/latest#FuncPlotter/FuncPlotterForm.vb">
source code</a> for this form is approx. one printed page.</p>
</div><div class="ClearBoth"></div>
